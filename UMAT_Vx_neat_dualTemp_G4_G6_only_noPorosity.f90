!*************************************************************************!
!
!                    DEFINITION SUBROUTINE UMAT
!
! Cure and temperature dependent viscoelastic model 
! MATERIALS: %
! COMPOSITE RELAXATION TIMES: 14
!
! IMPLEMENTATION METHOD: Backward Euler
!
! Last Modification: Anton Trofimov 4/01/2019
! Generated by MATLAB file: UMATgeneration_AT 
!*************************************************************************!
!
      SUBROUTINE UMAT_Vx_neat_dualTemp_G4_G6_only_noPorosity(STRESS,STATEV,DDSDDE,SSE,SPD,SCD,&
      RPL,DDSDDT,DRPLDE,DRPLDT,&
      STRAN,DSTRAN,TIME,DTIME,TEMP,DTEMP,PREDEF,DPRED,CMNAME,&
      NDI,NSHR,NTENS,NSTATV,PROPS,NPROPS,COORDS,DROT,PNEWDT,&
      CELENT,DFGRD0,DFGRD1,NOEL,NPT,LAYER,KSPT,KSTEP,KINC)
!
      IMPLICIT NONE
!
      CHARACTER*80 CMNAME
!
      INTEGER :: i,j,i_x,i_y
!
      INTEGER*8 :: NDI, NSHR, NTENS, NSTATV, NPROPS,&
             NOEL, NPT, LAYER, KSPT, KSTEP, KINC
!
      REAL*8 :: STRESS(NTENS), STATEV(NSTATV),&
             DDSDDE(NTENS,NTENS),&
             SSE, SPD, SCD,&
             RPL, DDSDDT(NTENS), DRPLDE(NTENS), DRPLDT,&
             STRAN(NTENS), DSTRAN(NTENS),&
             TIME(2), DTIME,&
             TEMP, DTEMP, PREDEF(*), DPRED(*),&
             PROPS(NPROPS),&
             COORDS(3),&
             DROT(3,3),&
             PNEWDT,&
             CELENT,&
             DFGRD0(3,3), DFGRD1(3,3)
!
!*******************PROPERTIES DEFINITION*********************************!
!
      REAL*8 :: alpha ! DoC and DoC increment (if we have a link with heat transfer analysis)	
!
! DiBenedetto Model
!
      REAL*8 :: Tg_inf = 156.28000d+0  ![C] Fully cured glass transition Temp
      REAL*8 :: Tg_0 = 11.70000d+0  ![C] Monomer glass transition Temp
      REAL*8 :: lambda = 0.40230d+0  ! DiBenedetto equation constant
      REAL*8 :: Tg  ! DiBenedetto glass transition temperature
!
! Arrhenius Shift Factor model
!
      REAL*8 :: H1_a = 39.63101d+0  ! [J/mol]
      REAL*8 :: H2_a = 39.63101d+0  ! [J/mol]
      REAL*8 :: H1_b = 18.19609d+0  ![J/mol]
      REAL*8 :: H2_b = 18.19609d+0  ![J/mol]
      REAL*8 :: E_a  ! [J/mol]- Activation energy shift factor below Tg
      REAL*8 :: E_a2  ! [J/mol]- Activation energy shift factor above Tg
      REAL*8 :: R = 0.00831d+0  ! [J/K.mmol]- Universal gas constant
      REAL*8 :: ln10 = 2.30259d+0
      REAL*8 :: aT,h ! Shift Factor and time step
      REAL, DIMENSION (NTENS,NTENS) :: K1,K2,p_alpha ! matrices to calculate p_alpha !
! Viscoelastic model
!
      INTEGER*8 :: PRONY = 14 ! Number of prony series
      REAL,DIMENSION(14):: tau !  Composite relaxation times
!
! For Euler method
!
      REAL*8 :: A  ! inverse aT
      INTEGER :: L_B, R_B ! for p_alpha.*L2 calculation
      REAL, DIMENSION (NTENS,NTENS) :: C_inf, C_sum, L1,LL, LL1 ! C_sum is used for L1 calc 
      REAL, DIMENSION (NTENS*14) :: vector_diag, W1_1 ! vector diag is used to calculate L3
      REAL, DIMENSION (NTENS,NTENS*14) :: L2, L2_alpha ! see Euler scheme
      REAL, DIMENSION (NTENS*14,NTENS) :: L2_alpha_t,L2_t ! [Pa] 
      REAL, DIMENSION (NTENS*14,NTENS*14) :: W1 ! see Euler scheme
      REAL, DIMENSION (NTENS*14,NTENS) :: W2 ! see Euler scheme
      REAL, DIMENSION (NTENS,NTENS*14) :: M2 ! see Euler scheme
      REAL, DIMENSION (NTENS*14) :: chi, chi_n ! Hidden internal variables defined

! DoC recovery from a previous simulation (if linked with heat analysis)

      alpha=1.0d0! if you couple with UEXPAN change it to alpha = statev(NSTATV)

! Relaxation time- 1 per decade 

      tau(1) = 1d-9
      tau(2) = 1d-8
      tau(3) = 1d-7
      tau(4) = 1d-6
      tau(5) = 1d-5
      tau(6) = 1d-4
      tau(7) = 1d-3
      tau(8) = 1d-2
      tau(9) = 1d-1
      tau(10) = 1d0
      tau(11) = 1d1
      tau(12) = 1d2
      tau(13) = 1d3
      tau(14) = 1d4

      !DoC and Temperature dependence (aT and palpha)
      !	DiBenedetto Model
      Tg = lambda*alpha*(Tg_inf-Tg_0)/(1-(1-lambda)*alpha)+Tg_0 ! [Cï¿½]

      !	Arrhenius Shift factor Model
      IF (Temp.GE.Tg) THEN
         E_a2 = H2_a*alpha+H2_b
         aT=10**(E_a2*(1/(Temp+273.15d0)-1/(Tg+273.15d0))/(R*ln10))
      ELSE
         E_a= H1_a*alpha+H1_b
         aT=10**(E_a*(1/(Temp+273.15d0)-1/(Tg+273.15d0))/(R*ln10))
      ENDIF

      !	P(alpha) Model

      ! K1 and K2 to construct p_alpha
      DO i=1,NTENS
         DO j=1,NTENS
              K1(i,j)=0.D0
              K2(i,j)=0.D0
         ENDDO
      ENDDO

      !	Definition of MATRIX material parameters

      !	Definition of Composite material parameters. X1 - must be the axis of anisotropy

      !
      K1(1,1) = 0.5000
      K1(1,2) = 0.5000
      K1(1,3) = 0.5000
      K1(1,4) = 0.0000
      K1(1,5) = 0.0000
      K1(1,6) = 0.0000
      !
      K1(2,1) = 0.5000
      K1(2,2) = 0.5000
      K1(2,3) = 0.5000
      K1(2,4) = 0.0000
      K1(2,5) = 0.0000
      K1(2,6) = 0.0000
      !
      K1(3,1) = 0.5000
      K1(3,2) = 0.5000
      K1(3,3) = 0.5000
      K1(3,4) = 0.0000
      K1(3,5) = 0.0000
      K1(3,6) = 0.0000
      !
      K1(4,1) = 0.0000
      K1(4,2) = 0.0000
      K1(4,3) = 0.0000
      K1(4,4) = 0.5000
      K1(4,5) = 0.0000
      K1(4,6) = 0.0000
      !
      K1(5,1) = 0.0000
      K1(5,2) = 0.0000
      K1(5,3) = 0.0000
      K1(5,4) = 0.0000
      K1(5,5) = 0.5000
      K1(5,6) = 0.0000
      !
      K1(6,1) = 0.0000
      K1(6,2) = 0.0000
      K1(6,3) = 0.0000
      K1(6,4) = 0.0000
      K1(6,5) = 0.0000
      K1(6,6) = 0.5000
      !
      K2(1,1) = 0.5000
      K2(1,2) = 0.5000
      K2(1,3) = 0.5000
      K2(1,4) = 0.0000
      K2(1,5) = 0.0000
      K2(1,6) = 0.0000
      !
      K2(2,1) = 0.5000
      K2(2,2) = 0.5000
      K2(2,3) = 0.5000
      K2(2,4) = 0.0000
      K2(2,5) = 0.0000
      K2(2,6) = 0.0000
      !
      K2(3,1) = 0.5000
      K2(3,2) = 0.5000
      K2(3,3) = 0.5000
      K2(3,4) = 0.0000
      K2(3,5) = 0.0000
      K2(3,6) = 0.0000
      !
      K2(4,1) = 0.0000
      K2(4,2) = 0.0000
      K2(4,3) = 0.0000
      K2(4,4) = 0.5000
      K2(4,5) = 0.0000
      K2(4,6) = 0.0000
      !
      K2(5,1) = 0.0000
      K2(5,2) = 0.0000
      K2(5,3) = 0.0000
      K2(5,4) = 0.0000
      K2(5,5) = 0.5000
      K2(5,6) = 0.0000
      !
      K2(6,1) = 0.0000
      K2(6,2) = 0.0000
      K2(6,3) = 0.0000
      K2(6,4) = 0.0000
      K2(6,5) = 0.0000
      K2(6,6) = 0.5000
      !
      !
      ! Non DOC of cure dependant parts (for L1 computation) are imported from Matlab

      !
      C_inf(1,1) = 6627.3715
      C_inf(1,2) = 4091.5728
      C_inf(1,3) = 4091.5728
      C_inf(1,4) = 0.0000
      C_inf(1,5) = 0.0000
      C_inf(1,6) = 0.0000
      !
      C_inf(2,1) = 4091.5728
      C_inf(2,2) = 6627.3715
      C_inf(2,3) = 4091.5728
      C_inf(2,4) = 0.0000
      C_inf(2,5) = 0.0000
      C_inf(2,6) = 0.0000
      !
      C_inf(3,1) = 4091.5728
      C_inf(3,2) = 4091.5728
      C_inf(3,3) = 6627.3715
      C_inf(3,4) = 0.0000
      C_inf(3,5) = 0.0000
      C_inf(3,6) = 0.0000
      !
      C_inf(4,1) = 0.0000
      C_inf(4,2) = 0.0000
      C_inf(4,3) = 0.0000
      C_inf(4,4) = 1267.8994
      C_inf(4,5) = 0.0000
      C_inf(4,6) = 0.0000
      !
      C_inf(5,1) = 0.0000
      C_inf(5,2) = 0.0000
      C_inf(5,3) = 0.0000
      C_inf(5,4) = 0.0000
      C_inf(5,5) = 1267.8994
      C_inf(5,6) = 0.0000
      !
      C_inf(6,1) = 0.0000
      C_inf(6,2) = 0.0000
      C_inf(6,3) = 0.0000
      C_inf(6,4) = 0.0000
      C_inf(6,5) = 0.0000
      C_inf(6,6) = 1267.8994
      !
      C_sum(1,1) = 83446.4985
      C_sum(1,2) = 794.1504
      C_sum(1,3) = 794.1504
      C_sum(1,4) = 0.0000
      C_sum(1,5) = 0.0000
      C_sum(1,6) = 0.0000
      !
      C_sum(2,1) = 794.1504
      C_sum(2,2) = 83446.4985
      C_sum(2,3) = 794.1504
      C_sum(2,4) = 0.0000
      C_sum(2,5) = 0.0000
      C_sum(2,6) = 0.0000
      !
      C_sum(3,1) = 794.1504
      C_sum(3,2) = 794.1504
      C_sum(3,3) = 83446.4985
      C_sum(3,4) = 0.0000
      C_sum(3,5) = 0.0000
      C_sum(3,6) = 0.0000
      !
      C_sum(4,1) = 0.0000
      C_sum(4,2) = 0.0000
      C_sum(4,3) = 0.0000
      C_sum(4,4) = 41326.1740
      C_sum(4,5) = 0.0000
      C_sum(4,6) = 0.0000
      !
      C_sum(5,1) = 0.0000
      C_sum(5,2) = 0.0000
      C_sum(5,3) = 0.0000
      C_sum(5,4) = 0.0000
      C_sum(5,5) = 41326.1740
      C_sum(5,6) = 0.0000
      !
      C_sum(6,1) = 0.0000
      C_sum(6,2) = 0.0000
      C_sum(6,3) = 0.0000
      C_sum(6,4) = 0.0000
      C_sum(6,5) = 0.0000
      C_sum(6,6) = 41326.1740
      !
      !  L2 Computation - Computed in Matlab to reduce computation time
      !
      !
      L2(1,1) = 437235.8407
      L2(2,1) = 0.0000
      L2(3,1) = 0.0000
      L2(4,1) = 0.0000
      L2(5,1) = 0.0000
      L2(6,1) = 0.0000
      !
      L2(1,2) = 0.0000
      L2(2,2) = 437235.8407
      L2(3,2) = 0.0000
      L2(4,2) = 0.0000
      L2(5,2) = 0.0000
      L2(6,2) = 0.0000
      !
      L2(1,3) = 0.0000
      L2(2,3) = 0.0000
      L2(3,3) = 437235.8407
      L2(4,3) = 0.0000
      L2(5,3) = 0.0000
      L2(6,3) = 0.0000
      !
      L2(1,4) = 0.0000
      L2(2,4) = 0.0000
      L2(3,4) = 0.0000
      L2(4,4) = 309172.4279
      L2(5,4) = 0.0000
      L2(6,4) = 0.0000
      !
      L2(1,5) = 0.0000
      L2(2,5) = 0.0000
      L2(3,5) = 0.0000
      L2(4,5) = 0.0000
      L2(5,5) = 309172.4279
      L2(6,5) = 0.0000
      !
      L2(1,6) = 0.0000
      L2(2,6) = 0.0000
      L2(3,6) = 0.0000
      L2(4,6) = 0.0000
      L2(5,6) = 0.0000
      L2(6,6) = 309172.4279
      !
      L2(1,7) = 2864270.6446
      L2(2,7) = 24132.8510
      L2(3,7) = 24132.8510
      L2(4,7) = 0.0000
      L2(5,7) = 0.0000
      L2(6,7) = 0.0000
      !
      L2(1,8) = 0.0000
      L2(2,8) = 2864168.9774
      L2(3,8) = 23930.3696
      L2(4,8) = 0.0000
      L2(5,8) = 0.0000
      L2(6,8) = 0.0000
      !
      L2(1,9) = 0.0000
      L2(2,9) = 0.0000
      L2(3,9) = 2864069.0055
      L2(4,9) = 0.0000
      L2(5,9) = 0.0000
      L2(6,9) = 0.0000
      !
      L2(1,10) = 0.0000
      L2(2,10) = 0.0000
      L2(3,10) = 0.0000
      L2(4,10) = 2016794.8965
      L2(5,10) = 0.0000
      L2(6,10) = 0.0000
      !
      L2(1,11) = 0.0000
      L2(2,11) = 0.0000
      L2(3,11) = 0.0000
      L2(4,11) = 0.0000
      L2(5,11) = 2016794.8965
      L2(6,11) = 0.0000
      !
      L2(1,12) = 0.0000
      L2(2,12) = 0.0000
      L2(3,12) = 0.0000
      L2(4,12) = 0.0000
      L2(5,12) = 0.0000
      L2(6,12) = 2016794.8965
      !
      L2(1,13) = 47275.4412
      L2(2,13) = 4535.4105
      L2(3,13) = 4535.4105
      L2(4,13) = 0.0000
      L2(5,13) = 0.0000
      L2(6,13) = 0.0000
      !
      L2(1,14) = 0.0000
      L2(2,14) = 47057.3840
      L2(3,14) = 4119.3022
      L2(4,14) = 0.0000
      L2(5,14) = 0.0000
      L2(6,14) = 0.0000
      !
      L2(1,15) = 0.0000
      L2(2,15) = 0.0000
      L2(3,15) = 46876.7398
      L2(4,15) = 0.0000
      L2(5,15) = 0.0000
      L2(6,15) = 0.0000
      !
      L2(1,16) = 0.0000
      L2(2,16) = 0.0000
      L2(3,16) = 0.0000
      L2(4,16) = 31784.8533
      L2(5,16) = 0.0000
      L2(6,16) = 0.0000
      !
      L2(1,17) = 0.0000
      L2(2,17) = 0.0000
      L2(3,17) = 0.0000
      L2(4,17) = 0.0000
      L2(5,17) = 31784.8533
      L2(6,17) = 0.0000
      !
      L2(1,18) = 0.0000
      L2(2,18) = 0.0000
      L2(3,18) = 0.0000
      L2(4,18) = 0.0000
      L2(5,18) = 0.0000
      L2(6,18) = 31784.8533
      !
      L2(1,19) = 8269.7076
      L2(2,19) = 3570.9462
      L2(3,19) = 3570.9462
      L2(4,19) = 0.0000
      L2(5,19) = 0.0000
      L2(6,19) = 0.0000
      !
      L2(1,20) = 0.0000
      L2(2,20) = 7458.9817
      L2(3,20) = 2249.5060
      L2(4,20) = 0.0000
      L2(5,20) = 0.0000
      L2(6,20) = 0.0000
      !
      L2(1,21) = 0.0000
      L2(2,21) = 0.0000
      L2(3,21) = 7111.6897
      L2(4,21) = 0.0000
      L2(5,21) = 0.0000
      L2(6,21) = 0.0000
      !
      L2(1,22) = 0.0000
      L2(2,22) = 0.0000
      L2(3,22) = 0.0000
      L2(4,22) = 4407.7989
      L2(5,22) = 0.0000
      L2(6,22) = 0.0000
      !
      L2(1,23) = 0.0000
      L2(2,23) = 0.0000
      L2(3,23) = 0.0000
      L2(4,23) = 0.0000
      L2(5,23) = 4407.7989
      L2(6,23) = 0.0000
      !
      L2(1,24) = 0.0000
      L2(2,24) = 0.0000
      L2(3,24) = 0.0000
      L2(4,24) = 0.0000
      L2(5,24) = 0.0000
      L2(6,24) = 4407.7989
      !
      L2(1,25) = 2013.8138
      L2(2,25) = 0.0364
      L2(3,25) = 0.0364
      L2(4,25) = 0.0000
      L2(5,25) = 0.0000
      L2(6,25) = 0.0000
      !
      L2(1,26) = 0.0000
      L2(2,26) = 2013.8138
      L2(3,26) = 0.0364
      L2(4,26) = 0.0000
      L2(5,26) = 0.0000
      L2(6,26) = 0.0000
      !
      L2(1,27) = 0.0000
      L2(2,27) = 0.0000
      L2(3,27) = 2013.8138
      L2(4,27) = 0.0000
      L2(5,27) = 0.0000
      L2(6,27) = 0.0000
      !
      L2(1,28) = 0.0000
      L2(2,28) = 0.0000
      L2(3,28) = 0.0000
      L2(4,28) = 1423.9685
      L2(5,28) = 0.0000
      L2(6,28) = 0.0000
      !
      L2(1,29) = 0.0000
      L2(2,29) = 0.0000
      L2(3,29) = 0.0000
      L2(4,29) = 0.0000
      L2(5,29) = 1423.9685
      L2(6,29) = 0.0000
      !
      L2(1,30) = 0.0000
      L2(2,30) = 0.0000
      L2(3,30) = 0.0000
      L2(4,30) = 0.0000
      L2(5,30) = 0.0000
      L2(6,30) = 1423.9685
      !
      L2(1,31) = 2143.1791
      L2(2,31) = 3.8832
      L2(3,31) = 3.8832
      L2(4,31) = 0.0000
      L2(5,31) = 0.0000
      L2(6,31) = 0.0000
      !
      L2(1,32) = 0.0000
      L2(2,32) = 2143.1756
      L2(3,32) = 3.8762
      L2(4,32) = 0.0000
      L2(5,32) = 0.0000
      L2(6,32) = 0.0000
      !
      L2(1,33) = 0.0000
      L2(2,33) = 0.0000
      L2(3,33) = 2143.1721
      L2(4,33) = 0.0000
      L2(5,33) = 0.0000
      L2(6,33) = 0.0000
      !
      L2(1,34) = 0.0000
      L2(2,34) = 0.0000
      L2(3,34) = 0.0000
      L2(4,34) = 1514.0829
      L2(5,34) = 0.0000
      L2(6,34) = 0.0000
      !
      L2(1,35) = 0.0000
      L2(2,35) = 0.0000
      L2(3,35) = 0.0000
      L2(4,35) = 0.0000
      L2(5,35) = 1514.0829
      L2(6,35) = 0.0000
      !
      L2(1,36) = 0.0000
      L2(2,36) = 0.0000
      L2(3,36) = 0.0000
      L2(4,36) = 0.0000
      L2(5,36) = 0.0000
      L2(6,36) = 1514.0829
      !
      L2(1,37) = 37.8593
      L2(2,37) = 0.2314
      L2(3,37) = 0.2314
      L2(4,37) = 0.0000
      L2(5,37) = 0.0000
      L2(6,37) = 0.0000
      !
      L2(1,38) = 0.0000
      L2(2,38) = 37.8586
      L2(3,38) = 0.2300
      L2(4,38) = 0.0000
      L2(5,38) = 0.0000
      L2(6,38) = 0.0000
      !
      L2(1,39) = 0.0000
      L2(2,39) = 0.0000
      L2(3,39) = 37.8579
      L2(4,39) = 0.0000
      L2(5,39) = 0.0000
      L2(6,39) = 0.0000
      !
      L2(1,40) = 0.0000
      L2(2,40) = 0.0000
      L2(3,40) = 0.0000
      L2(4,40) = 26.6886
      L2(5,40) = 0.0000
      L2(6,40) = 0.0000
      !
      L2(1,41) = 0.0000
      L2(2,41) = 0.0000
      L2(3,41) = 0.0000
      L2(4,41) = 0.0000
      L2(5,41) = 26.6886
      L2(6,41) = 0.0000
      !
      L2(1,42) = 0.0000
      L2(2,42) = 0.0000
      L2(3,42) = 0.0000
      L2(4,42) = 0.0000
      L2(5,42) = 0.0000
      L2(6,42) = 26.6886
      !
      L2(1,43) = 1.1493
      L2(2,43) = 0.0027
      L2(3,43) = 0.0027
      L2(4,43) = 0.0000
      L2(5,43) = 0.0000
      L2(6,43) = 0.0000
      !
      L2(1,44) = 0.0000
      L2(2,44) = 1.1493
      L2(3,44) = 0.0027
      L2(4,44) = 0.0000
      L2(5,44) = 0.0000
      L2(6,44) = 0.0000
      !
      L2(1,45) = 0.0000
      L2(2,45) = 0.0000
      L2(3,45) = 1.1493
      L2(4,45) = 0.0000
      L2(5,45) = 0.0000
      L2(6,45) = 0.0000
      !
      L2(1,46) = 0.0000
      L2(2,46) = 0.0000
      L2(3,46) = 0.0000
      L2(4,46) = 0.8117
      L2(5,46) = 0.0000
      L2(6,46) = 0.0000
      !
      L2(1,47) = 0.0000
      L2(2,47) = 0.0000
      L2(3,47) = 0.0000
      L2(4,47) = 0.0000
      L2(5,47) = 0.8117
      L2(6,47) = 0.0000
      !
      L2(1,48) = 0.0000
      L2(2,48) = 0.0000
      L2(3,48) = 0.0000
      L2(4,48) = 0.0000
      L2(5,48) = 0.0000
      L2(6,48) = 0.8117
      !
      L2(1,49) = 57.0296
      L2(2,49) = 0.0079
      L2(3,49) = 0.0079
      L2(4,49) = 0.0000
      L2(5,49) = 0.0000
      L2(6,49) = 0.0000
      !
      L2(1,50) = 0.0000
      L2(2,50) = 57.0296
      L2(3,50) = 0.0079
      L2(4,50) = 0.0000
      L2(5,50) = 0.0000
      L2(6,50) = 0.0000
      !
      L2(1,51) = 0.0000
      L2(2,51) = 0.0000
      L2(3,51) = 57.0296
      L2(4,51) = 0.0000
      L2(5,51) = 0.0000
      L2(6,51) = 0.0000
      !
      L2(1,52) = 0.0000
      L2(2,52) = 0.0000
      L2(3,52) = 0.0000
      L2(4,52) = 40.3232
      L2(5,52) = 0.0000
      L2(6,52) = 0.0000
      !
      L2(1,53) = 0.0000
      L2(2,53) = 0.0000
      L2(3,53) = 0.0000
      L2(4,53) = 0.0000
      L2(5,53) = 40.3232
      L2(6,53) = 0.0000
      !
      L2(1,54) = 0.0000
      L2(2,54) = 0.0000
      L2(3,54) = 0.0000
      L2(4,54) = 0.0000
      L2(5,54) = 0.0000
      L2(6,54) = 40.3232
      !
      L2(1,55) = 9.6689
      L2(2,55) = 5.2576
      L2(3,55) = 5.2576
      L2(4,55) = 0.0000
      L2(5,55) = 0.0000
      L2(6,55) = 0.0000
      !
      L2(1,56) = 0.0000
      L2(2,56) = 8.1145
      L2(3,56) = 2.8582
      L2(4,56) = 0.0000
      L2(5,56) = 0.0000
      L2(6,56) = 0.0000
      !
      L2(1,57) = 0.0000
      L2(2,57) = 0.0000
      L2(3,57) = 7.5945
      L2(4,57) = 0.0000
      L2(5,57) = 0.0000
      L2(6,57) = 0.0000
      !
      L2(1,58) = 0.0000
      L2(2,58) = 0.0000
      L2(3,58) = 0.0000
      L2(4,58) = 4.6181
      L2(5,58) = 0.0000
      L2(6,58) = 0.0000
      !
      L2(1,59) = 0.0000
      L2(2,59) = 0.0000
      L2(3,59) = 0.0000
      L2(4,59) = 0.0000
      L2(5,59) = 4.6181
      L2(6,59) = 0.0000
      !
      L2(1,60) = 0.0000
      L2(2,60) = 0.0000
      L2(3,60) = 0.0000
      L2(4,60) = 0.0000
      L2(5,60) = 0.0000
      L2(6,60) = 4.6181
      !
      L2(1,61) = 0.0050
      L2(2,61) = 0.0001
      L2(3,61) = 0.0001
      L2(4,61) = 0.0000
      L2(5,61) = 0.0000
      L2(6,61) = 0.0000
      !
      L2(1,62) = 0.0000
      L2(2,62) = 0.0050
      L2(3,62) = 0.0001
      L2(4,62) = 0.0000
      L2(5,62) = 0.0000
      L2(6,62) = 0.0000
      !
      L2(1,63) = 0.0000
      L2(2,63) = 0.0000
      L2(3,63) = 0.0050
      L2(4,63) = 0.0000
      L2(5,63) = 0.0000
      L2(6,63) = 0.0000
      !
      L2(1,64) = 0.0000
      L2(2,64) = 0.0000
      L2(3,64) = 0.0000
      L2(4,64) = 0.0035
      L2(5,64) = 0.0000
      L2(6,64) = 0.0000
      !
      L2(1,65) = 0.0000
      L2(2,65) = 0.0000
      L2(3,65) = 0.0000
      L2(4,65) = 0.0000
      L2(5,65) = 0.0035
      L2(6,65) = 0.0000
      !
      L2(1,66) = 0.0000
      L2(2,66) = 0.0000
      L2(3,66) = 0.0000
      L2(4,66) = 0.0000
      L2(5,66) = 0.0000
      L2(6,66) = 0.0035
      !
      L2(1,67) = 0.0461
      L2(2,67) = 0.0000
      L2(3,67) = 0.0000
      L2(4,67) = 0.0000
      L2(5,67) = 0.0000
      L2(6,67) = 0.0000
      !
      L2(1,68) = 0.0000
      L2(2,68) = 0.0461
      L2(3,68) = 0.0000
      L2(4,68) = 0.0000
      L2(5,68) = 0.0000
      L2(6,68) = 0.0000
      !
      L2(1,69) = 0.0000
      L2(2,69) = 0.0000
      L2(3,69) = 0.0461
      L2(4,69) = 0.0000
      L2(5,69) = 0.0000
      L2(6,69) = 0.0000
      !
      L2(1,70) = 0.0000
      L2(2,70) = 0.0000
      L2(3,70) = 0.0000
      L2(4,70) = 0.0326
      L2(5,70) = 0.0000
      L2(6,70) = 0.0000
      !
      L2(1,71) = 0.0000
      L2(2,71) = 0.0000
      L2(3,71) = 0.0000
      L2(4,71) = 0.0000
      L2(5,71) = 0.0326
      L2(6,71) = 0.0000
      !
      L2(1,72) = 0.0000
      L2(2,72) = 0.0000
      L2(3,72) = 0.0000
      L2(4,72) = 0.0000
      L2(5,72) = 0.0000
      L2(6,72) = 0.0326
      !
      L2(1,73) = 0.0521
      L2(2,73) = 0.0043
      L2(3,73) = 0.0043
      L2(4,73) = 0.0000
      L2(5,73) = 0.0000
      L2(6,73) = 0.0000
      !
      L2(1,74) = 0.0000
      L2(2,74) = 0.0519
      L2(3,74) = 0.0040
      L2(4,74) = 0.0000
      L2(5,74) = 0.0000
      L2(6,74) = 0.0000
      !
      L2(1,75) = 0.0000
      L2(2,75) = 0.0000
      L2(3,75) = 0.0518
      L2(4,75) = 0.0000
      L2(5,75) = 0.0000
      L2(6,75) = 0.0000
      !
      L2(1,76) = 0.0000
      L2(2,76) = 0.0000
      L2(3,76) = 0.0000
      L2(4,76) = 0.0353
      L2(5,76) = 0.0000
      L2(6,76) = 0.0000
      !
      L2(1,77) = 0.0000
      L2(2,77) = 0.0000
      L2(3,77) = 0.0000
      L2(4,77) = 0.0000
      L2(5,77) = 0.0353
      L2(6,77) = 0.0000
      !
      L2(1,78) = 0.0000
      L2(2,78) = 0.0000
      L2(3,78) = 0.0000
      L2(4,78) = 0.0000
      L2(5,78) = 0.0000
      L2(6,78) = 0.0353
      !
      L2(1,79) = 0.0000
      L2(2,79) = 0.0000
      L2(3,79) = 0.0000
      L2(4,79) = 0.0000
      L2(5,79) = 0.0000
      L2(6,79) = 0.0000
      !
      L2(1,80) = 0.0000
      L2(2,80) = 0.0000
      L2(3,80) = 0.0000
      L2(4,80) = 0.0000
      L2(5,80) = 0.0000
      L2(6,80) = 0.0000
      !
      L2(1,81) = 0.0000
      L2(2,81) = 0.0000
      L2(3,81) = 0.0000
      L2(4,81) = 0.0000
      L2(5,81) = 0.0000
      L2(6,81) = 0.0000
      !
      L2(1,82) = 0.0000
      L2(2,82) = 0.0000
      L2(3,82) = 0.0000
      L2(4,82) = 0.0000
      L2(5,82) = 0.0000
      L2(6,82) = 0.0000
      !
      L2(1,83) = 0.0000
      L2(2,83) = 0.0000
      L2(3,83) = 0.0000
      L2(4,83) = 0.0000
      L2(5,83) = 0.0000
      L2(6,83) = 0.0000
      !
      L2(1,84) = 0.0000
      L2(2,84) = 0.0000
      L2(3,84) = 0.0000
      L2(4,84) = 0.0000
      L2(5,84) = 0.0000
      L2(6,84) = 0.0000
      !*************************Computation of L1, L2, p_alpha.*L2****************************!
      DO i=1,NTENS
         DO j=1,NTENS
            p_alpha(i,j) = 0
         ENDDO
      ENDDO

      p_alpha = K1*alpha + K2
      DO i=1,NTENS
         DO j=1,NTENS
            L1(i,j) = C_inf(i,j) + C_sum(i,j)*p_alpha(i,j)
         ENDDO
      ENDDO

      DO i_x=1,NTENS
         DO i_y=1,NTENS*PRONY
            L2_alpha(i_x,i_y)=0.0
         ENDDO
      ENDDO

      DO i_x=1,PRONY
         L_B = 1 +NTENS*(i_x-1)
         R_B = 6 +NTENS*(i_x-1)
         LL = L2(1:6,L_B:R_B)
         DO i=1,NTENS
            DO j=1,NTENS
              LL1(i,j) = LL(i,j)*p_alpha(i,j)
            ENDDO
         ENDDO
         L2_alpha(1:NTENS,L_B:R_B)=LL1
      ENDDO

      !	 Compute L2_t
      DO i= 1, NTENS
         DO j= 1, NTENS*PRONY
            L2_t(j,i)=0.0d+0
            L2_alpha_t(j,i)=0.0d+0
         ENDDO
      ENDDO

      DO i= 1, NTENS
         DO j= 1, NTENS*PRONY
            L2_t(j,i)=L2(i,j)
            L2_alpha_t(j,i)=L2_alpha(i,j)
         ENDDO
      ENDDO

      h=DTIME
      !
      !*************************Euler****************************!
      !
      ! W1 COMPUTATION
      !
      DO i= 1,PRONY
         DO j= 1, NTENS
            vector_diag(j+(NTENS*(i-1)))=1/tau(i)
         ENDDO
      ENDDO

      A = 1/aT

      DO i= 1, NTENS*PRONY
         W1_1(i)=1/(1+h*A*vector_diag(i))
      ENDDO

      DO i=1,NTENS*PRONY
         DO j=1,NTENS*PRONY
              W1(i,j)=0.0d0
              W1(i,i)=W1_1(i)
         ENDDO
      ENDDO
      !	 W2 Computation

      DO i= 1, NTENS*PRONY
         DO j= 1, NTENS
            W2(i,j) = -h*W1_1(i)*A*L2_alpha_t(i,j)
         ENDDO
      ENDDO

      ! INTERNAL VARIABLES COMPUTATION (CHI)
      ! Set Chi and Chi_n to zero

      DO i= 1, NTENS*PRONY
         chi(i)=0.0d0
         chi_n(i)=0.0d0
      ENDDO

      ! Statev is Chi(n)
      DO i=1, NTENS*PRONY
         chi_n(i)=statev(i)
      ENDDO
      chi = matmul(W1, chi_n)+ matmul(W2,(stran+dstran))

      ! Jacobian matrix DDSDDE
      DO i=1, NTENS
         DO j=1, NTENS
            DDSDDE(i,j)=0.0d0
         ENDDO
      ENDDO
      DDSDDE=L1+matmul(L2_alpha,W2)
      M2=matmul(L2_alpha,W1)

      ! STRESS COMPUTATION
      stress=matmul(DDSDDE,(stran+dstran))+matmul(M2,chi_n)

      ! UPDATE INTERNAL
      DO i=1, NTENS*PRONY
         STATEV(i)=CHI(i)
      ENDDO

      ENDSUBROUTINE
!																		  !
!																		  !
!						   	 END SUBROUTINE UMAT		     			  !
!																		  !
!*************************************************************************!
